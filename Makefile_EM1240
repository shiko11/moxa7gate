CC=arm-elf-gcc
STRIP=file
LDFLAGS=-Wl,-elf2flt 
ARCHNAME=EM1240

moxa:
	$(CC) -o km400 $(LDFLAGS) \
-DMOXA7GATE_KM400 \
-DMOXA7GATE_WITHOUT_HMI_KLB \
-DMOXA7GATE_WITHOUT_IFACE_TCPSERVER \
-DMOXA7GATE_WITHOUT_IFACE_RTUSLAVE \
main.c cli.c messages.c statistics.c hmi_web.c \
modbus_rtu.c modbus_tcp.c forwarding.c clients.c \
moxagate.c iface_rtumaster.c iface_tcpmaster.c interfaces.c \
mxlib/mxwdg_lx.c kltm/kltm.c kltm/kltm_main.c IEC870_3/IEC870_3.c \
serial/serial.c \
-lpthread

	$(STRIP) -s km400

clean:
	rm -f km400 km400.gdb
